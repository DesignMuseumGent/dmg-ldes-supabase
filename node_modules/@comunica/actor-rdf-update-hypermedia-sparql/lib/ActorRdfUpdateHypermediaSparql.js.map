{"version":3,"file":"ActorRdfUpdateHypermediaSparql.js","sourceRoot":"","sources":["ActorRdfUpdateHypermediaSparql.ts"],"names":[],"mappings":";;;AAGA,mFAA+E;AAE/E,mEAAgE;AAEhE;;GAEG;AACH,MAAa,8BAA+B,SAAQ,oDAAwB;IAK1E,YAAmB,IAAyC;QAC1D,KAAK,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;IACxB,CAAC;IAEM,KAAK,CAAC,YAAY,CAAC,MAAkC;QAC1D,IAAI,CAAC,MAAM,CAAC,oBAAoB,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,aAAa;YAChE,CAAC,CAAC,IAAI,CAAC,oBAAoB,IAAI,MAAM,CAAC,GAAG,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;YAC9D,CAAC,CAAC,IAAI,CAAC,oBAAoB,IAAI,MAAM,CAAC,GAAG,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE;YAChE,MAAM,IAAI,KAAK,CAAC,SAAS,IAAI,CAAC,IAAI,qFAAqF,CAAC,CAAC;SAC1H;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAEM,KAAK,CAAC,GAAG,CAAC,MAAkC;QACjD,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,EAAE,qCAAqC,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC;QAChF,OAAO;YACL,WAAW,EAAE,IAAI,6CAAqB,CACpC,MAAM,CAAC,QAAQ,CAAC,aAAa,IAAI,MAAM,CAAC,GAAG,EAC3C,MAAM,CAAC,OAAO,EACd,IAAI,CAAC,YAAY,CAClB;SACF,CAAC;IACJ,CAAC;CACF;AA5BD,wEA4BC","sourcesContent":["import type { MediatorHttp } from '@comunica/bus-http';\nimport type { IActionRdfUpdateHypermedia, IActorRdfUpdateHypermediaOutput,\n  IActorRdfUpdateHypermediaArgs } from '@comunica/bus-rdf-update-hypermedia';\nimport { ActorRdfUpdateHypermedia } from '@comunica/bus-rdf-update-hypermedia';\nimport type { IActorTest } from '@comunica/core';\nimport { QuadDestinationSparql } from './QuadDestinationSparql';\n\n/**\n * A comunica SPARQL RDF Update Hypermedia Actor.\n */\nexport class ActorRdfUpdateHypermediaSparql extends ActorRdfUpdateHypermedia {\n  public readonly mediatorHttp: MediatorHttp;\n  public readonly checkUrlSuffixSparql: boolean;\n  public readonly checkUrlSuffixUpdate: boolean;\n\n  public constructor(args: IActorRdfUpdateHypermediaSparqlArgs) {\n    super(args, 'sparql');\n  }\n\n  public async testMetadata(action: IActionRdfUpdateHypermedia): Promise<IActorTest> {\n    if (!action.forceDestinationType && !action.metadata.sparqlService &&\n      !(this.checkUrlSuffixSparql && action.url.endsWith('/sparql')) &&\n      !(this.checkUrlSuffixUpdate && action.url.endsWith('/update'))) {\n      throw new Error(`Actor ${this.name} could not detect a SPARQL service description or URL ending on /sparql or /update.`);\n    }\n    return true;\n  }\n\n  public async run(action: IActionRdfUpdateHypermedia): Promise<IActorRdfUpdateHypermediaOutput> {\n    this.logInfo(action.context, `Identified as sparql destination: ${action.url}`);\n    return {\n      destination: new QuadDestinationSparql(\n        action.metadata.sparqlService || action.url,\n        action.context,\n        this.mediatorHttp,\n      ),\n    };\n  }\n}\n\nexport interface IActorRdfUpdateHypermediaSparqlArgs extends IActorRdfUpdateHypermediaArgs {\n  /**\n   * The HTTP mediator\n   */\n  mediatorHttp: MediatorHttp;\n  /**\n   * If URLs ending with '/sparql' should also be considered SPARQL endpoints.\n   * @default {true}\n   */\n  checkUrlSuffixSparql: boolean;\n  /**\n   * If URLs ending with '/update' should also be considered SPARQL endpoints.\n   * @default {true}\n   */\n  checkUrlSuffixUpdate: boolean;\n}\n"]}